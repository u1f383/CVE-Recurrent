# CVE-2019-8942

1. After you complete the installation, takes a screenshot of your phpinfo page with the following information.

![](https://i.imgur.com/pbasnQl.png)
![](https://i.imgur.com/A03Z9a3.png)


2. Assume that you use wordpress_{student_id} (e.g., wordpress_0812345) as database name during the WorkPress installation process. Now, use the following SQL statement via MySQL-CLI interface to list the tables and paste the list in your report.
- USE wordpress_{student_id}; SHOW TABLES

![](https://i.imgur.com/lLUybEl.png)

3. Show the results from running the shell command ‘ip addr' on the WordPress server

![](https://i.imgur.com/sLU1Y5r.png)

4. At Step 15 in the tutorial, a command-line shell was created. Use the built-in Linux command to check the principal (the username) of the shell process. Take a screenshot and mark the username

![](https://i.imgur.com/idP8A0K.png)


5. At Step 12 of the tutorial, we cropped the image to create the jpg image inside the theme folder. The corresponding code is shown as follows:

**A -> B -> C -> E**

``` php
if ( is_numeric( $src ) ) {
    $src_file = get_attached_file( $src )
    // 這邊 $src_file 得到的會像是:
    // /var/www/html/wordpress/wp-contents/uploads/2021/05/payload.jpg?/../../../../themes/twentynineteen/shell

    if ( ! file_exists( $src_file ) ) {
    // 而該檔案在 FS 上並不存在，因此 wp 會去存取 URL src link:
    // http://localhost/wordpress/<>/payload.jpg?/../../../../themes/twentynineteen/shell
    // 而因為 url 的 ? 後面接的是 parameter，因此實際上能夠存取到 payload.jpg
        $src = _load_image_to_edit_path( $src, 'full' );
    } else {
        $src = $src_file;
    }
}
```

6. Why didn’t the Imagick re-encoding remove the PHP payload from the image? Did the payload also survive (not removed by) the processing by the GD library? Also, upload the cropped jpg file generated by GD even if the payload is removed. You need to provide the explanations, not just answering yes/no.